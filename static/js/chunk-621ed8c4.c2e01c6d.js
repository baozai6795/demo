(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-621ed8c4"],{"12b0":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{ref:"queryForm",attrs:{model:e.queryParams,size:"small",inline:!0}},[a("el-form-item",{attrs:{label:"当前工作项目",prop:"selectedProject"}},[a("el-select",{attrs:{"value-key":"name",placeholder:"搜索并选择所属项目",filterable:"",remote:"","remote-method":e.queryProjects,loading:e.projectQueryLoading},on:{change:e.selectedProjectChanged},model:{value:e.selectedProject,callback:function(t){e.selectedProject=t},expression:"selectedProject"}},e._l(e.projects,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e}})})),1)],1)],1),a("div",{staticClass:"textType"},[e._v("基本资料")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.materialList,"row-key":"id"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),a("el-table-column",{attrs:{prop:"materialType",label:"资料类型","show-overflow-tooltip":!1}}),a("el-table-column",{attrs:{prop:"fileName",label:"文件名称","show-overflow-tooltip":!1}}),a("el-table-column",{attrs:{prop:"createBy",label:"上传人员","show-overflow-tooltip":!1}}),a("el-table-column",{attrs:{label:"上传时间",align:"center",prop:"createTime"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.parseTime(t.row.createTime)))])]}}])}),a("el-table-column",{attrs:{prop:"status",label:"状态","show-overflow-tooltip":!1},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.status?a("span",[e._v("待审核")]):e._e(),1==t.row.status?a("span",[e._v("接收")]):e._e(),2==t.row.status?a("span",[e._v("反驳")]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"version",label:"版本号","show-overflow-tooltip":!1}}),a("el-table-column",{attrs:{prop:"examineName",label:"审核人","show-overflow-tooltip":!1}}),a("el-table-column",{attrs:{prop:"examineTime",label:"审核时间","show-overflow-tooltip":!1}}),a("el-table-column",{attrs:{prop:"examineContent",label:"审核意见","show-overflow-tooltip":!1}}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"text"}},[e._v("下载")]),a("el-button",{attrs:{size:"mini",type:"text"}},[e._v("详情")]),a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return e.handleAddMaterial(t.row)}}},[e._v("上传")]),0==t.row.status?a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return e.handleExamineMaterial(t.row)}}},[e._v("审核")]):e._e()]}}])})],1),a("div",{staticClass:"textType"},[e._v("其他资料")]),a("div",{staticClass:"dowbutton"},[a("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("上传")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.materialList,"row-key":"id"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),a("el-table-column",{attrs:{prop:"materialType",label:"资料类型","show-overflow-tooltip":!1}}),a("el-table-column",{attrs:{prop:"fileName",label:"文件名称","show-overflow-tooltip":!1}}),a("el-table-column",{attrs:{prop:"createBy",label:"上传人员","show-overflow-tooltip":!1}}),a("el-table-column",{attrs:{label:"上传时间",align:"center",prop:"createTime"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.parseTime(t.row.createTime)))])]}}])}),a("el-table-column",{attrs:{prop:"status",label:"状态","show-overflow-tooltip":!1},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.status?a("span",[e._v("待审核")]):e._e(),1==t.row.status?a("span",[e._v("接收")]):e._e(),2==t.row.status?a("span",[e._v("反驳")]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"version",label:"版本号","show-overflow-tooltip":!1}}),a("el-table-column",{attrs:{prop:"examineName",label:"审核人","show-overflow-tooltip":!1}}),a("el-table-column",{attrs:{prop:"examineTime",label:"审核时间","show-overflow-tooltip":!1}}),a("el-table-column",{attrs:{prop:"examineContent",label:"审核意见","show-overflow-tooltip":!1}}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"text"}},[e._v("下载")]),a("el-button",{attrs:{size:"mini",type:"text"}},[e._v("详情")]),a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return e.handleAddMaterial(t.row)}}},[e._v("上传")]),0==t.row.status?a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return e.handleExamineMaterial(t.row)}}},[e._v("审核")]):e._e()]}}])})],1),e.projectSelectedFlag?a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}}):e._e(),a("el-dialog",{attrs:{title:"收资函文本",visible:e.mailTextDialogOpen,width:"680px"},on:{"update:visible":function(t){e.mailTextDialogOpen=t}}}),a("el-dialog",{attrs:{title:"审核意见",visible:e.examineMaterialVisible,width:"680px"},on:{"update:visible":function(t){e.examineMaterialVisible=t}}},[a("el-form",{ref:"uexamineMaterialForm",attrs:{model:e.examineMaterialFormModel,"label-width":"100px"}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"资料名称",prop:"fileName"}},[a("el-input",{model:{value:e.examineMaterialFormModel.fileName,callback:function(t){e.$set(e.examineMaterialFormModel,"fileName",t)},expression:"examineMaterialFormModel.fileName"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"资料类型",prop:"materialType"}},[a("el-input",{model:{value:e.examineMaterialFormModel.materialType,callback:function(t){e.$set(e.examineMaterialFormModel,"materialType",t)},expression:"examineMaterialFormModel.materialType"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"新版本版本号",prop:"version"}},[a("el-input",{model:{value:e.examineMaterialFormModel.version,callback:function(t){e.$set(e.examineMaterialFormModel,"version",t)},expression:"examineMaterialFormModel.version"}},[a("el-button",{attrs:{slot:"suffix",type:"primary"},slot:"suffix"},[e._v("下载")])],1)],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"审核意见",prop:"examineContent"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.examineMaterialFormModel.examineContent,callback:function(t){e.$set(e.examineMaterialFormModel,"examineContent",t)},expression:"examineMaterialFormModel.examineContent"}})],1)],1)],1)],1),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.chalexamineMaterial(1==e.examineMaterialFormModel.isPass)}}},[e._v("通过")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.chalexamineMaterial(0==e.examineMaterialFormModel.isPass)}}},[e._v("驳回")])],1)],1),a("el-dialog",{attrs:{title:"上传资料",visible:e.uploadMaterialVisible,width:"680px"},on:{"update:visible":function(t){e.uploadMaterialVisible=t}}},[a("el-form",{ref:"uploadMaterialForm",attrs:{model:e.uploadMaterialFormModel,"label-width":"100px",rules:e.uploadMaterialRules}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"资料类型",prop:"materialType"}},[a("el-input",{model:{value:e.uploadMaterialFormModel.materialType,callback:function(t){e.$set(e.uploadMaterialFormModel,"materialType",t)},expression:"uploadMaterialFormModel.materialType"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"新版本版本号",prop:"version"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.uploadMaterialFormModel.version,callback:function(t){e.$set(e.uploadMaterialFormModel,"version",t)},expression:"uploadMaterialFormModel.version"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"文件上传"}},[a("el-upload",{ref:"upload",attrs:{limit:1,action:e.upload.url,"file-list":e.upload.fileList,headers:e.upload.headers,"on-success":e.handleFileSuccess,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")])],1)],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"无文件说明",prop:"fileContent"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.uploadMaterialFormModel.fileContent,callback:function(t){e.$set(e.uploadMaterialFormModel,"fileContent",t)},expression:"uploadMaterialFormModel.fileContent"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"自动通过审核",prop:"isExamine"}},[a("el-switch",{model:{value:e.uploadMaterialFormModel.isExamine,callback:function(t){e.$set(e.uploadMaterialFormModel,"isExamine",t)},expression:"uploadMaterialFormModel.isExamine"}})],1)],1)],1)],1),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"}},[e._v("确定")]),a("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)},o=[],i=(a("b0c0"),a("d81d"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),a("bf97")),r=a("15ab"),n=a("42f5"),s=a("5f87"),u={name:"MaterialCollect",data:function(){return{projectSelectedFlag:!1,materialCollectText:"",projects:[],projectQueryLoading:!1,materialQueryLoading:!1,selectMaterials:[],total:0,selectedProject:void 0,queryParams:{pageNum:1,pageSize:10,projectId:void 0},mailInfoForm:{},loading:!1,materialList:[{materialType:"设计方案",fileName:"2020-xxx设计",createBy:"xioaming",createTime:"2020-1-1",status:2,version:"v2",examineName:"李四",examineTime:"2020-5-13",examineContent:"不通过"},{materialType:"设计方案",fileName:"2020-xxx设计",createBy:"xioaming",createTime:"2020-1-1",status:1,version:"v2",examineName:"李四",examineTime:"2020-5-13",examineContent:"不通过"},{materialType:"设计方案",fileName:"2020-xxx设计",createBy:"xioaming",createTime:"2020-1-1",status:0,version:"v2",examineName:"李四",examineTime:"2020-5-13",examineContent:"不通过"}],examineMaterialVisible:!1,examineMaterialFormModel:{fileName:"",version:"",materialType:"",examineContent:"",isPass:""},open:!1,mailTextDialogOpen:!1,uploadMaterialVisible:!1,templates:[],upload:{headers:{Authorization:"Bearer "+Object(s["a"])()},url:"/prod-api/common/upload",fileList:[]},uploadMaterialFormModel:{materialType:"设计方案",version:"v2",file:"",fileContent:"",isExamine:!1},mailInfoRules:{template:[{required:!0,message:"关联模板不能为空",trigger:"blur"}],receiver:[{required:!0,message:"收件人不能为空",trigger:"blur"}],sender:[{required:!0,message:"发件人不能为空",trigger:"blur"}],contact:[{required:!0,message:"联系方式不能为空",trigger:"blur"}],description:[{required:!0,message:"说明不能为空",trigger:"blur"}]},uploadMaterialRules:{name:[{required:!0,message:"资料名称不能为空",trigger:"blur"}]}}},created:function(){this.queryProjects("")},methods:{queryProjects:function(e){var t=this;this.projectQueryLoading=!0,Object(i["i"])(e).then((function(e){t.projects=e.projects,t.projectQueryLoading=!1}))},handleSelectionChange:function(e){this.selectMaterials=e},cancel:function(){},handleExamineMaterial:function(e){this.examineMaterialVisible=!this.examineMaterialVisible,this.examineMaterialFormModel.fileName=e.fileName,this.examineMaterialFormModel.version=e.version,this.examineMaterialFormModel.materialType=e.materialType},chalexamineMaterial:function(){},resetAddMailForm:function(){this.mailInfoForm={template:void 0,projectName:this.selectedProject.name,editDept:this.selectedProject.editDept,receiver:void 0,sender:void 0,contact:void 0,description:void 0},this.materialCollectText="",this.resetForm("mailInfoForm")},selectedProjectChanged:function(e){this.projectSelectedFlag=!0,this.selectedProject=e},finishMaterialsCollect:function(){this.resetForm("queryForm"),this.handleQuery()},handleAddMail:function(e){this.resetAddMailForm(),this.queryMailTemplates(""),this.open=!0},queryMailTemplates:function(e){var t=this;this.materialQueryLoading=!0,Object(n["b"])(e).then((function(e){t.templates=e.templates,t.materialQueryLoading=!1}))},handleAddMaterial:function(e){this.uploadMaterialVisible=!0,this.uploadMaterialFormModel.materialType=e.materialType,this.uploadMaterialFormModel.version=e.version},resetUploadMaterialForm:function(){this.uploadMaterialFormModel={name:void 0,projectName:this.selectedProject.name,editDept:this.selectedProject.editDept},this.upload.fileList=[]},handleUploadMaterial:function(){var e=this;this.$refs["uploadMaterialForm"].validate((function(t){t&&e.$refs.upload.submit()}))},handleFileSuccess:function(e,t,a){var l=this,o={name:this.uploadMaterialFormModel.name,status:"已上传",projectId:this.selectedProject.id,distPath:e.url};Object(r["a"])(o).then((function(e){l.$modal.msgSuccess("保存成功"),l.uploadMaterialVisible=!1}))},handleDownload:function(){var e=this,t=this.selectMaterials.map((function(e){return e.id})),a="".concat(this.selectedProject.name,"-资料.zip");Object(r["b"])(t).then((function(t){e.$modal.msgSuccess("下载成功");var l=t,o=new Blob([l]);if("download"in document.createElement("a")){var i=document.createElement("a");i.download=a,i.style.display="none",i.href=URL.createObjectURL(o),document.body.appendChild(i),i.click(),URL.revokeObjectURL(i.href),document.body.removeChild(i)}else navigator.msSaveBlob(o,a)}))},handleUpdate:function(e){},submitMailInfoForm:function(){var e=this;this.$refs["mailInfoForm"].validate((function(t){t&&Object(n["a"])(e.mailInfoForm.template,e.mailInfoForm).then((function(t){e.materialCollectText=t.text,e.open=!1,e.mailTextDialogOpen=!0}))}))},copyMailTextSuccess:function(){this.$modal.msgSuccess("复制成功")},copyMailTextFailed:function(){this.$modal.msgError("复制失败")},handleDelete:function(e){var t=this;this.$modal.confirm('是否确认删除名称为"'+e.menuName+'"的数据项？').then((function(){return delMenu(e.menuId)})).then((function(){t.$modal.msgSuccess("删除成功")})).catch((function(){}))}}},c=u,m=(a("ebc8"),a("2877")),d=Object(m["a"])(c,l,o,!1,null,"2c187fe4",null);t["default"]=d.exports},"15ab":function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var l=a("b775");function o(e){return Object(l["a"])({url:"/material/pageList",method:"get",params:e})}function i(e){return Object(l["a"])({url:"/material/add",method:"post",data:e})}function r(e){return Object(l["a"])({url:"/material/download",method:"post",data:e,responseType:"blob"})}},1651:function(e,t,a){},"42f5":function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return i}));var l=a("b775");function o(e){return Object(l["a"])({url:"/template/queryByName?query="+e,method:"get"})}function i(e,t){return Object(l["a"])({url:"/template/getMailText?id="+e,method:"post",data:t})}},bf97:function(e,t,a){"use strict";a.d(t,"j",(function(){return o})),a.d(t,"k",(function(){return i})),a.d(t,"g",(function(){return r})),a.d(t,"i",(function(){return n})),a.d(t,"b",(function(){return s})),a.d(t,"n",(function(){return u})),a.d(t,"c",(function(){return c})),a.d(t,"e",(function(){return m})),a.d(t,"o",(function(){return d})),a.d(t,"l",(function(){return p}));var l=a("b775");function o(e){return Object(l["a"])({url:"/project/pageList",method:"get",params:e})}function i(){return Object(l["a"])({url:"/project/listRunning",method:"get"})}function r(e){return Object(l["a"])({url:"/project/getById/"+e,method:"get"})}function n(e){return Object(l["a"])({url:"/project/queryByName?query="+e,method:"get"})}function s(e){return Object(l["a"])({url:"/project/add",method:"post",data:e})}function u(e){return Object(l["a"])({url:"/project/update",method:"put",data:e})}function c(e){return Object(l["a"])({url:"/project/check",method:"post",data:e})}function m(e){return Object(l["a"])({url:"/project/deleteById?id="+e,method:"delete"})}function d(e,t){return Object(l["a"])({url:"/project/updateStatus/"+e+"/"+t,method:"get"})}function p(e){return Object(l["a"])({url:"/project/selectUserByProjectId/"+e,method:"get"})}},ebc8:function(e,t,a){"use strict";a("1651")}}]);