(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-91159736"],{"5f56":function(r,e,t){},"7e15":function(r,e,t){"use strict";t.r(e);var o=function(){var r=this,e=r.$createElement,t=r._self._c||e;return t("div",{staticClass:"app-container"},[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:4}},[t("span",{staticStyle:{"font-size":"20px"}},[t("b",[r._v("当前工作项目:")])])]),t("el-col",{attrs:{span:18}},[t("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",placeholder:"请选择当前工作项目",disabled:!0},model:{value:r.form.project.id,callback:function(e){r.$set(r.form.project,"id",e)},expression:"form.project.id"}},r._l(r.projectList,(function(r){return t("el-option",{key:r.id,attrs:{label:r.code+" "+r.name,value:r.id}})})),1)],1)],1),t("el-divider"),t("el-form",{ref:"form",attrs:{model:r.form,rules:r.rules,"label-width":"80px"}},[t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:10}},[t("el-form-item",{attrs:{label:"报告文件",prop:"reportManager.reportName"}},[t("el-input",{attrs:{disabled:""},model:{value:r.form.reportManager.reportName,callback:function(e){r.$set(r.form.reportManager,"reportName",e)},expression:"form.reportManager.reportName"}})],1)],1),t("el-col",{attrs:{span:2}},[t("el-button",{attrs:{type:"primary"},on:{click:r.downloadReportFile}},[r._v("下载")])],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"文件版本",prop:"reportManager.reportVersion"}},[t("el-input",{attrs:{disabled:""},model:{value:r.form.reportManager.reportVersion,callback:function(e){r.$set(r.form.reportManager,"reportVersion",e)},expression:"form.reportManager.reportVersion"}})],1)],1)],1),t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"上传人",prop:"reportManager.createBy"}},[t("el-input",{attrs:{disabled:""},model:{value:r.form.reportManager.createBy,callback:function(e){r.$set(r.form.reportManager,"createBy",e)},expression:"form.reportManager.createBy"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"上传时间",prop:"reportManager.createTime"}},[t("el-input",{attrs:{disabled:""},model:{value:r.form.reportManager.createTime,callback:function(e){r.$set(r.form.reportManager,"createTime",e)},expression:"form.reportManager.createTime"}})],1)],1)],1),t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"审核人",prop:"reportApproval.userName"}},[t("el-input",{attrs:{disabled:""},model:{value:r.form.reportApproval.userName,callback:function(e){r.$set(r.form.reportApproval,"userName",e)},expression:"form.reportApproval.userName"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"审核时间",prop:"reportApproval.approvalTime"}},[t("el-input",{attrs:{disabled:""},model:{value:r.form.reportApproval.approvalTime,callback:function(e){r.$set(r.form.reportApproval,"approvalTime",e)},expression:"form.reportApproval.approvalTime"}})],1)],1)],1),t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"审核状态",prop:"reportApproval.status"}},[t("el-radio",{attrs:{label:1,disabled:r.isReadOnly},model:{value:r.form.reportApproval.status,callback:function(e){r.$set(r.form.reportApproval,"status",e)},expression:"form.reportApproval.status"}},[r._v("同意")]),t("el-radio",{attrs:{label:-1,disabled:r.isReadOnly},model:{value:r.form.reportApproval.status,callback:function(e){r.$set(r.form.reportApproval,"status",e)},expression:"form.reportApproval.status"}},[r._v("驳回")])],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"意见文件",prop:"reportApproval.approvalFile"}},[t("el-row",[t("el-upload",{ref:"upload",staticClass:"upload-file-uploader",attrs:{action:r.upload.uploadFileUrl,"file-list":r.upload.approvalFileList,"on-error":r.handleUploadError,"on-remove":r.handleRemove,"before-remove":r.beforeRemove,limit:1,"on-exceed":r.handleLimit,"on-success":r.handleUploadFileSuccess,"show-file-list":!0,headers:r.upload.headers}},[r.isReadOnly?r._e():t("el-button",{staticStyle:{"margin-right":"10px"},attrs:{slot:"trigger",type:"primary"},slot:"trigger"},[r._v("上传")]),t("el-button",{attrs:{type:"primary",disabled:void 0==r.form.reportApproval.approvalFile||null==r.form.reportApproval.approvalFile||""==r.form.reportApproval.approvalFile},on:{click:r.downloadApprovalFile}},[r._v(" 下载 ")]),r.isReadOnly?t("span",{staticStyle:{"margin-left":"10px"},attrs:{prop:"reportApproval.approvalFile"}},[r._v(r._s(this.form.reportApproval.approvalFile))]):r._e()],1)],1)],1)],1)],1),t("el-row",{attrs:{gutter:20}}),t("el-row",{attrs:{gutter:10}},[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"意见详情",prop:"reportApproval.remark"}},[t("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:15},maxlength:1e4,"show-word-limit":"",disabled:r.isReadOnly||r.isRemarkDisabled},model:{value:r.form.reportApproval.remark,callback:function(e){r.$set(r.form.reportApproval,"remark",e)},expression:"form.reportApproval.remark"}})],1)],1)],1)],1),t("div",{staticClass:"dialog-footer",staticStyle:{display:"block","text-align":"center",width:"83.3%"},attrs:{slot:"footer"},slot:"footer"},[r.isReadOnly?r._e():t("el-button",{attrs:{type:"primary"},on:{click:r.submit}},[r._v("确 认")]),t("el-button",{on:{click:r.goback}},[r._v("返 回")])],1)],1)},a=[],l=(t("b0c0"),t("bf97")),n=t("9ad0"),p=t("5f87"),i={name:"reportDetail",dicts:[],data:function(){return{form:{reportManager:{reportName:void 0,reportVersion:void 0,createBy:void 0,createTime:void 0},reportApproval:{userName:void 0,approvalTime:void 0,status:void 0,approvalFile:void 0,remark:void 0}},projectList:[],remarkDisabled:!1,readOnly:!0,upload:{baseUrl:"/prod-api",uploadFileUrl:"/prod-api/common/upload",headers:{Authorization:"Bearer "+Object(p["a"])()},fileList:[],approvalFileList:[]},rules:{}}},created:function(){this.getProjectList(),this.getForm()},computed:{isReadOnly:function(){return"true"==this.readOnly},isRemarkDisabled:function(){return this.remarkDisabled}},methods:{getForm:function(){var r=this,e=this.$route.query.reportId,t=this.$route.query.userId;this.readOnly=this.$route.query.readOnly,Object(n["b"])(e,t).then((function(e){r.form=e.data,console.log(e.data.reportApproval.remark,"remark"),void 0!=e.data.reportApproval.remark&&null!=e.data.reportApproval.remark&&""!=e.data.reportApproval.remark&&(console.log("true"),r.remarkDisabled=!0),console.log(r.form,"form"),console.log(r.form.project.id,"id")}))},getProjectList:function(){var r=this;Object(l["k"])().then((function(e){r.projectList=e.data}))},downloadReportFile:function(){this.$download.resource(this.form.reportManager.reportAddress)},downloadApprovalFile:function(){this.$download.resource(this.form.reportApproval.approvalFileAddress)},handleUploadError:function(){this.$message.error("文件上传失败, 请重试")},cancelUpload:function(){this.form.reportApproval.approvalFile=void 0,this.form.reportApproval.approvalFileAddress=void 0,this.upload.approvalFileList=[]},handleUploadFileSuccess:function(r){this.upload.fileList[0]={name:r.newFileName,url:r.url},this.form.reportApproval.approvalFileAddress=r.url,this.form.reportApproval.approvalFile=r.originalFilename},beforeRemove:function(r,e){return this.$confirm("确定移除 ".concat(r.name,"？"))},handleRemove:function(r,e){console.log(r,e),this.form.reportApproval.approvalFile=void 0,this.form.reportApproval.approvalFileAddress=void 0,this.upload.approvalFileList=[]},submit:function(){var r=this;void 0!=r.form.reportApproval.status&&0!=r.form.reportApproval.status?this.$modal.confirm("是否确定提交?").then((function(){r.$refs["form"].validate((function(e){if(e)Object(n["g"])(r.form.reportApproval).then((function(e){r.$store.dispatch("tagsView/delView",r.$route),r.$router.go("-1"),r.$modal.msgSuccess("标记成功")}));else{var t=document.querySelectorAll("el-form-item__error");t.scrollIntoView({behavior:"smooth",block:"center"})}}))})):this.$message.error("审批状态必选, 请检查")},goback:function(){var r=this;this.$modal.confirm("是否确定返回?").then((function(){r.$store.dispatch("tagsView/delView",r.$route),r.$router.go("-1")}))},handleLimit:function(r,e){this.$message.warning("只可上传一个文件")}}},s=i,u=(t("b664"),t("2877")),c=Object(u["a"])(s,o,a,!1,null,null,null);e["default"]=c.exports},"9ad0":function(r,e,t){"use strict";t.d(e,"e",(function(){return a})),t.d(e,"h",(function(){return l})),t.d(e,"f",(function(){return n})),t.d(e,"c",(function(){return p})),t.d(e,"a",(function(){return i})),t.d(e,"b",(function(){return s})),t.d(e,"g",(function(){return u})),t.d(e,"i",(function(){return c})),t.d(e,"d",(function(){return d}));var o=t("b775");function a(r){return Object(o["a"])({url:"/report/manager/listPage",method:"post",data:r})}function l(r){return Object(o["a"])({url:"/report/manager/save",method:"post",data:r})}function n(r){return Object(o["a"])({url:"/report/manager/release/"+r,method:"get"})}function p(r){return Object(o["a"])({url:"/report/manager/getRejectIds/"+r,method:"get"})}function i(r){return Object(o["a"])({url:"/report/manager/getApprovalList/"+r,method:"get"})}function s(r,e){return Object(o["a"])({url:"/report/manager/getManagerApproval/"+r+"/"+e,method:"get"})}function u(r){return Object(o["a"])({url:"/report/manager/reportApproval",method:"post",data:r})}function c(r){return Object(o["a"])({url:"/report/manager/selectAllApproval",method:"post",data:r})}function d(r){return Object(o["a"])({url:"/report/manager/getVersionList/"+r,method:"get"})}},b664:function(r,e,t){"use strict";t("5f56")},bf97:function(r,e,t){"use strict";t.d(e,"j",(function(){return a})),t.d(e,"k",(function(){return l})),t.d(e,"g",(function(){return n})),t.d(e,"i",(function(){return p})),t.d(e,"b",(function(){return i})),t.d(e,"n",(function(){return s})),t.d(e,"c",(function(){return u})),t.d(e,"e",(function(){return c})),t.d(e,"o",(function(){return d})),t.d(e,"l",(function(){return m}));var o=t("b775");function a(r){return Object(o["a"])({url:"/project/pageList",method:"get",params:r})}function l(){return Object(o["a"])({url:"/project/listRunning",method:"get"})}function n(r){return Object(o["a"])({url:"/project/getById/"+r,method:"get"})}function p(r){return Object(o["a"])({url:"/project/queryByName?query="+r,method:"get"})}function i(r){return Object(o["a"])({url:"/project/add",method:"post",data:r})}function s(r){return Object(o["a"])({url:"/project/update",method:"put",data:r})}function u(r){return Object(o["a"])({url:"/project/check",method:"post",data:r})}function c(r){return Object(o["a"])({url:"/project/deleteById?id="+r,method:"delete"})}function d(r,e){return Object(o["a"])({url:"/project/updateStatus/"+r+"/"+e,method:"get"})}function m(r){return Object(o["a"])({url:"/project/selectUserByProjectId/"+r,method:"get"})}}}]);